<div mat-dialog-title class="modal-header">
  <div class="modal-title">
    {{"person.upsert"|translate}}
  </div>
</div>
<div class="modal-body" dir="rtl" [style.width.px]="500" [style.height.px]="400" autoTranslate>
  <form [formGroup]="data.form">
    <mat-horizontal-stepper #stepper [linear]="false">
      <mat-step [stepControl]="data.form" label="{{'steps'|translate:({value:'first'|translate})}}">

        <div formGroupName="person">
          <div fxLayout="row" fxflex>
            <mat-form-field fxFlex>
              <input matInput placeholder="person.nc" formControlName="nationalCode" #natCode (focusout)="findPerson(natCode)">
            </mat-form-field>
            <mat-form-field fxFlex>
              <input matInput placeholder="person.mobileNumber" formControlName="mobileNumber">
            </mat-form-field>
          </div>
          <div fxLayout="row" fxflex>
            <trn-slider fxFlex trueText="male" falseText="female" formControlName="gender"></trn-slider>
          </div>
          <div fxLayout="row">
            <mat-form-field fxFlex>
              <input matInput placeholder="person.name" formControlName="name">
            </mat-form-field>
            <mat-form-field fxFlex>
              <input matInput placeholder="person.family" formControlName="family">
            </mat-form-field>
          </div>
          <div fxLayout="row">
            <mat-form-field fxFlex>
              <input matInput placeholder="person.englishName" formControlName="englishName">
            </mat-form-field>
            <mat-form-field fxFlex>
              <input matInput placeholder="person.englishFamily" formControlName="englishFamily">
            </mat-form-field>
          </div>
          <div fxLayout="row">
            <mat-form-field fxFlex>
              <input matInput (click)="bithDate._open($event)" [matDatepicker]="personBirthDate" placeholder="person.birthDate" formControlName="birthDate">
              <mat-datepicker-toggle utc="true" #bithDate matSuffix [for]="personBirthDate"></mat-datepicker-toggle>
              <mat-datepicker #personBirthDate disabled="false" (selectedChanged)="age($event)"></mat-datepicker>
            </mat-form-field>
          </div>
        </div>
      </mat-step>

      <mat-step [stepControl]="data.form" label="{{'steps'|translate:({value:'second'|translate})}}" formGroupName="person">
        <div fxLayout="row">
          <mat-form-field fxFlex>
            <input matInput="number" placeholder="passport.number" formControlName="passportNo">
          </mat-form-field>
          <mat-form-field fxFlex>
            <input matInput (click)="passExpDate._open($event)" [matDatepicker]="passExpireDate" placeholder="passport.expireDate" formControlName="passportExpireDate">
            <mat-datepicker-toggle utc="true" #passExpDate matSuffix [for]="passExpireDate"></mat-datepicker-toggle>
            <mat-datepicker #passExpireDate disabled="false"></mat-datepicker>
          </mat-form-field>
        </div>
        <div fxLayout="row">
          <mat-form-field fxFlex>
            <input matInput (click)="visaExpDate._open($event)" [matDatepicker]="visaExpireDate" placeholder="person.visaExpireDate"
              formControlName="visaExpirDate">
            <mat-datepicker-toggle utc="true" #visaExpDate matSuffix [for]="visaExpireDate"></mat-datepicker-toggle>
            <mat-datepicker #visaExpireDate disabled="false"></mat-datepicker>
          </mat-form-field>
        </div>
        <br>
        <div fxLayout="row">
          <div fxFlex>
            <mat-checkbox (change)="passDelivered($event)" [formControl]="data.form.get('passportDelivered')">{{"person.passportDelivered"|translate}}
            </mat-checkbox>
          </div>
          <div fxFlex>
            <mat-checkbox (change)="visaDelivered($event)" [formControl]="data.form.get('visaDelivered')">{{"person.visaDelivered"|translate}}
            </mat-checkbox>
          </div>
        </div>
        <hr noshade size="1">

        <div>
          <div fxLayout="row">
            <div fxFlex *ngFor="let option of data.form.controls.personIncomes.controls;let i=index">
              <div>
                <mat-checkbox [disabled]="!data.model.person.isUnder5" [formControl]="option.get('optionType')">{{"optionType."optionType[data.model.personIncomes[i].optionType]|translate}}
                </mat-checkbox>
              </div>
            </div>
          </div>
        </div>
        <hr noshade size="1">
        <div fxLayout="row">
          <p>
            خدمات فقط برای افراد بین 2 و 5 سال قابل تغییر می باشد
          </p>
        </div>
      </mat-step>

    </mat-horizontal-stepper>
  </form>
  <!--width set for IE-->
</div>
<div fxLayout="row" align="end">
  <button class="pull-left" mat-mini-fab color="primary" (click)="stepper.next()" [disabled]="stepper.selectedIndex==1">
    <mat-icon>navigate_before</mat-icon>
  </button>
  <button class="pull-right" mat-mini-fab color="primary" (click)="stepper.previous()" [disabled]='stepper.selectedIndex==0'>
    <mat-icon>navigate_next</mat-icon>
  </button>
</div>
<mat-dialog-actions>
  <button fxFlex mat-raised-button color="primary" (click)="close()">{{"save"|translate}}</button>
</mat-dialog-actions>